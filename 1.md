
目录

[1.把握现状和设定目标](#1把握现状和设定目标)

[2a数据原型的制作](#2a数据原型的制作)

[2a1 用工艺产能输入模板数据](#2a1-用工艺产能输入模板数据)

[2a2 班次的设定](#2a2-班次的设定)

[2a3 生产日历的设定](#2a3-生产日历的设定)

[2a4 资源表、物料表的设定](#2a4-资源表物料表的设定)

[2a5 计划基准时间、显示开始时间的设定](#2a5-计划基准时间显示开始时间的设定)

[2a6 副资源（作业员）的设定](#2a6-副资源作业员的设定)

[2a7 内设置资源的设定](#2a7-内设置资源的设定)

[2a8 外设置资源的设定](#2a8-外设置资源的设定)

[2a9 设定组装供需以后的模板数据](#2a9-设定组装供需以后的模板数据)

[2a10 输入制造订单，进行排程](#2a10-输入制造订单进行排程)

[2a11 参数化BOM](#2a11-参数化bom)

[2a12 技能表](#2a12-技能表)

[2b消除订单逾期、缩短制造提前期的技巧](#2b消除订单逾期缩短制造提前期的技巧)

[2b1 确认逾期的制造订单](#2b1-确认逾期的制造订单)

[2b2 变更开工时间，解除订单逾期](#2b2-变更开工时间解除订单逾期)

[2b3 分割制造订单，解除订单逾期](#2b3-分割制造订单解除订单逾期)

[2b4 分割工作，解除订单逾期](#2b4-分割工作解除订单逾期)

[2b5 变更接续方法，解除订单逾期](#2b5-变更接续方法解除订单逾期)

[2c 命令与排产方案](#2c-命令与排产方案)

[2c1 设定分派规则](#2c1-设定分派规则)

[2c2 设定评估表达式](#2c2-设定评估表达式)

[2c3 订单筛选、期间设定、复合排程](#2c3-订单筛选期间设定复合排程)

[2c4 正方向/逆方向排程](#2c4-正方向逆方向排程)

[2c5瓶颈中心排程](#2c5瓶颈中心排程)

[2d 资源条件设定及更现实设定的追加](#2d-资源条件设定及更现实设定的追加)

[2d1 按照资源量设定资源的资源量制约](#2d1-按照资源量设定资源的资源量制约)

[2d2 设定资源的分派有效条件](#2d2-设定资源的分派有效条件)

[2d3 设置制造中断时间MAX的设定](#2d3-设置制造中断时间max的设定)

[2e 与工作相关的各种制约](#2e-与工作相关的各种制约)

[2e1 关于时间固定级别的说明以及设定](#2e1-关于时间固定级别的说明以及设定)

[2e2 数量固定级别的说明以及设定](#2e2-数量固定级别的说明以及设定)

[2f 数据原型的制作——热处理的追加](#2f-数据原型的制作热处理的追加)

[2f1 订单规格（处理温度）的设定](#2f1-订单规格处理温度的设定)

[2f2 工序选定器有效条件的设定](#2f2-工序选定器有效条件的设定)

[2f3 用规格表示显示颜色的设定](#2f3-用规格表示显示颜色的设定)

[2f4 由于特征切换而发生的切换时间的设定](#2f4-由于特征切换而发生的切换时间的设定)

[2f5 追加炉资源的作业员](#2f5-追加炉资源的作业员)

[2f6 设定资源量](#2f6-设定资源量)

[2f7 设定炉资源](#2f7-设定炉资源)

[2f8 设定外协资源](#2f8-设定外协资源)

[2f9 设定任务主资源（资源的组合）](#2f9-设定任务主资源资源的组合)

[2f10任务选定器有效条件的设定](#2f10任务选定器有效条件的设定)

[2f11 外协资源的移动时间的设定](#2f11-外协资源的移动时间的设定)

[2f12 设定无限能力](#2f12-设定无限能力)

[2f13 制造中断时间 MAX、设置中断时间 MAX 的设定](#2f13-制造中断时间-max设置中断时间-max-的设定)

[2g 数据原型的制作——其它功能](#2g-数据原型的制作其它功能)

[2g1 根据规格的分派条件的设定](#2g1-根据规格的分派条件的设定)

[2g2 由于物料切换、副资源切换而发生的切换时间的设定](#2g2-由于物料切换副资源切换而发生的切换时间的设定)

[2g3 使用指令有效条件的设定](#2g3-使用指令有效条件的设定)

[附录A 利益增大诊断确认表](#附录a-利益增大诊断确认表)

[附录B 利益增大诊断确认表](#附录b-利益增大诊断确认表)

-   本书目的

    依照本手册的内容，实习一遍 ABC 公司(虚构公司)推行的[利益增大项目]的详细内容。由此，各位读者可以掌握实际导入 排产易 时所必要的知识和技能。有关个别功能，如果需要详细学习，请查看用户手册。

## 1.把握现状和设定目标

导入 排产易 时，首先进行的是把握现状与设定目标。使用本手册附录 B 的利益增大诊断表，进行现状把握和目标设定。在这里，说明一下本手册附录 A 的利益增大诊断表填写例。在利益增大诊断表里有以下填写项目。

1\. 预计这次系统适用的产品群

决定使用排产易制定计划的产品（物料）。

可以将工厂制造所有的产品作为对象，也可以将一部分产品作为对象。如果将一部分产品作为对象，请尽量选择设备等不与对象外产品共用的产品。

2\. 产品的工序流程

记录被选为排程对象的产品的工序流程、月产量等。

3\. 各工序的设备、作业员、外协

填写在产品的工序流程里所记录的各工序的机器、作业员、外协等。出勤模式用于记录各个机器或作业员、外协的出勤模式。出勤模式的工作时间填写到下面的出勤模式表里。

4\. 出勤模式

将所记录的出勤模式的实际工作时间填入各个工序的设备、作业员、外协表中。

5\. 推测瓶颈工序

填写推测为瓶颈的工序以及其理由。

通过上述信息，可以整理出制作数据原型所必需的模版数据的基本信息。然后，进一步准备机器的能力值、设置时间等信息，便可以制作数据原型。

6\. 订单的状况和处理方法

填写订单的形态、件数、制作方法。另外，请填写平均交货提前期和交货期遵守率。

7\. 库存的状况

填写成品、半成品、采购品的库存。以便判断导入 排产易 后的改善状况。

通过上述记录可以整理出输入到排产易的有关订单的信息。而且，整理出平均交货提前期、交货期遵守率和库存状况，便于判断导入 排产易 之后的改善状况。

8\. 生产计划制作方法

记录计划制作周期、计划期间和排程方法的现状。还有，填写平均制造提前期。上述的计划制作周期、计划期间和排程方法作为决定 排产易 制作计划周期等的参考使用。另外，为了判断导入 排产易 之后制造提前期的改善状况，请整理制造提前期。

9\. 生产管理系统的现状

填写正在运行中或者今后预定使用的系统。

10\. 模版数据等的管理方法

填写现在的模版数据、订货信息、指示方法、实绩收集的方法。通过上述记录整理出与 排产易 相关的外部系统的信息。可以研讨和确认导入 排产易 时所必要的接口、新的或者修改系统。

利用利益增大诊断表整理这些信息，开始研讨 排产易 的导入

## 2a数据原型的制作

-   产品构成

    ![](media/e9d9c21036cba64c571099ece744414f.png)

    BX100、BX200、CX100、CX200 与 AX100、AX200 的结构相同。

-   工序图

M1 --\>切割 --\>加工 --\>检查1 --\> A

M1 --\>切割 --\>加工 --\>检查1 --\> B

M1 --\>切割--\>加工 --\>检查1 --\> C

M2 --\>成型 --\>检查2 --\>X

A, X --\>组装 --\>检查3 --\>AX

B, X --\>组装 --\>检查3 --\>BX

C, X --\>组装 --\>检查3 --\>CX

AX --\>包装 --\>AX100

AX --\>包装 --\>AX200

BX --\>包装 --\>BX100

BX --\>包装 --\>BX200

CX --\>包装 --\>CX100

CX --\>包装 --\>CX200

### 2a1 用工艺产能输入模板数据

工艺产能是设定模板数据（制造BOM）的表。让我们使用排产易的工艺产能来设定制造BOM。

1.从菜单的[排产基础数据/工艺产能]打开工艺产能表。

2.输入项目

■ 物料代码 （输入完成品的物料代码）。

■ 工序编号 （工序编号应该从先头工序到最终工序由小变大）。

■ 工序代码 （输入工序代码）。

■ 指令种类 （输入指令种类）。

输入指令 （输入指令是指工序中跟输入物料相关的指令）。

■ 指令代码 （缺省值为 In，可以设定任意代码。）。

■ 物料or资源代码（输入工序中输入的输入物料）。

■ 制造 （设定制造一个单位的物料所需要的输入物料的数量）。

■ 接续方法 （设定工序之间的接续方法）。

■ 移动时间 MIN （设定工序之间需要留出的最小时间）。

使用指令

■ 指令代码 （主资源缺省值为 M，副资源为S）。

■ 物料or资源代码（输入使用的资源）。

■ 前设置 （输入前设置中需要的时间）。

■ 制造 （输入制造中需要的能力值和能力单位）。

■ 后设置 （输入后设置中需要的时间）。

3.半成品A的工序流程图

![](media/d49240f03fde5aa22ff162ea667ae6e9.png)

半成品A的工序、设备、能力如上，制造所必要的输入物料数量在全部工序中设定为1。根据上面的信息设定制造BOM，其结果如下图所示：

![](media/a3cd0ee112ecb51655bbdc1f1077385b.png)

半成品A的工艺产能

### 2a2 班次的设定

1.设定班次。班次用于设定一天中工作时间段的模式。

输入项目

代码 （设定班次形态的名称）。

模式 （输入班次的出勤时间，输入时用分号隔开）。

2.设定从 8:00 到 18:00 出勤、并有一个小时的午休的模式，代码为 S1。

从菜单的[排产基础数据/班次]中打开班次表的界面，设定上面的出勤模式。

![](media/e0e275a9fa96ee6fa12bd888284e169f.png)

班次的设定结果

### 2a3 生产日历的设定

1\. 设定生产日历。生产日历设定每个资源/每天的出勤模式。

输入项目

资源 （\*表示全部资源，也可以对各个资源设定日历。）

日期/星期 （设定日期。既可以直接设定日期，也可以设定星期或者用短横线来设定范围。）

班次 （设定日历的班次）

优先级 （设定日历记录的顺序。优先级大的被应用。）

2\. 这次对所有资源的所有日期设定为班次S1。

从菜单的[排产基础数据/日历设置]中打开生产日历表的界面，设定上述的生产日历信息。

![](media/0d87651f75742d9317a84344f6af19ed.png)

生产日历的设定结果

### 2a4 资源表、物料表的设定

1\. 资源表的数据输入。

为了更容易查看资源甘特图，依照工序的流程输入显示颜色和显示顺序。

![](media/2eacf1458d94d28147b6bc623a0a51b7.png)

资源表的设定

2\. 物料表的数据输入。

为了更容易确认物料，请输入显示颜色和显示顺序。

![](media/6b4c14448c37803aa8807e27cc0c7dc6.png)

物料表的设定

### 2a5 计划基准时间、显示开始时间的设定

1\. 设定计划基准时间。

计划基准时间为其它时间的基准时间，一般指排程时的时间。如果要定义其它时间，一般直接输入或则间接取从计划基准时间开始的相对时间进行定义。

这次将计划基准时间设定为2003/10/01。

2\. 设定显示开始时间。

显示开始时间是开始显示图表的时间，这次设定过去的显示天数为 2 天。

选择菜单的「环境设置/期间设置」。

![](media/498c83696d83620ae41121b6844a3ae5.png)

计划基准时间、显示开始时间的设定

### 2a6 副资源（作业员）的设定

设定副资源(作业员或夹具)。副资源占用和主资源相同的时间。

1\. 在CK工序里设定检查员（CKR）。在工艺产能增加使用指令。

2\. 在指令代码里设定S0。在[物料or资源代码]里设定资源[CKR]。因为[CKR]在制造中使用，所以在制造栏里输入和CK1相同的值。输入[0]则意味着[配合主资源的资源能力的值]。

![](media/4cbcfae6eaa6dc16ed49023e035f59b4.png)

副资源的设定

3\. 在资源表上输入在工艺产能中所输入的资源CKR的显示颜色和显示顺序。

![](media/2b595b9ac4d923168a3af16aeb2ac7bb.png)

4\. 录入订单。

录入订单数量和交货期也和先前一样，设定数量是100、交货期是2003/10/31。

![](media/b07ea349441a7e26fd322fe3afe63b89.png)

排程：我们可以看到资源CKR和资源CK1同时分派。对1个工作，计划使用资源CK1（主资源）与资源CKR（副资源）2个资源。

![](media/1fc42435cedb2525bdd78f98ba7407ce.png)

### 2a7 内设置资源的设定

设定内设置资源。能够设定进行设置工作的作业员等，这样的资源称为内设置资源

1\. 在PR工序里设定资源PRIN作为内设置资源。

2\. 和追加副资源时一样，在PR工序里追加使用指令。指令代码设定为S0。

在[物料or资源代码]里设定资源代码[PRIN]。

![](media/cfb56fc3e2041b7a50244f17e360fd62.png)

3\. 因为内设置资源 PRIN 进行主资源「PR1」的内设置工作，所以资源的显示顺序依此设定。

![](media/bb2b9431f4e10a208861f7f47e74018a.png)

4\. 运行排产,数量和交货期的设定和先前一样。

内设置资源[PRIN]在资源[PR1]发生设置的时候分派，制定出的计划使之完成设置工作。

![](media/0e4be177f948c76458461ba1e75aaae9.png)

### 2a8 外设置资源的设定

设定外设置资源。把切割机 CT1 的前设置和后设置切换为外设置。

1\. 在 CT 工序里输入外设置资源 CTS。

在 CT 工序里追加[使用指令]。[指令代码]设定为 S0，在[物料or资源代码]里设定资源代码[CTS]。把在资源 CT1里所设定的前设置时间和后设置时间移动到资源 CTS 上。

![](media/bc99140a9b6428f4ca6aba08c95d7be4.png)

2\. 设定资源的显示颜色和显示顺序。

![](media/d0741cc53a7a53b32c1f928f93577f4f.png)

3\. 运行排产

在资源CT1上所分派的内设置变成外设置在资源CTS上分派。

![](media/3ff25aa1b3bd85d327c3938ef960b42e.png)

### 2a9 设定组装供需以后的模板数据

设定组装工序以后的模版数据。

1\. 导入数据，如下所示，录入了品目X、AX、AX100的模版数据。

![](media/92cc0db9cd229be12b08e368aaf1c0ac.png)

### 2a10 输入制造订单，进行排程

输入制造订单，重新排程。

1.  追加品目X、AX的订单。

![](media/9a024d5d20c1ab9bc3f12b54439254e4.png)

1.  接着重新排程,所追加的2个订单也已分派，订单之间关联了起来。

![](media/cea6709d98d0bb12026838f3d0344a51.png)

1.  追加AX100的订单。

![](media/1737c4f79e777822f486ea01223f58bb.png)

4\. 重新排程。

于是，新追加的订单M4也与现有的订单关联起来了。

![](media/8b388531c38a3442965a979d872b48d5.png)

### 2a11 参数化BOM

哪怕是同1个产品，也会发生由于客户等条件变化而使用的原料或部品也变化的情况。这种情况下，可以在工艺产能里，对根据条件而变化的原料或部品设定条件表达式，以此在1个物料上可以指定多种投入物料。通过从订单设定条件（参数），可以用符合条件的模版数据展开订单、进行分派。

这种工艺产能（制造BOM）的设定称为参数化BOM。

AX通常螺钉（半成品A）和螺帽部品X装配而成，假设也可以用别的螺帽X2来装配成AX。我们可以用参数化BOM进行设定。

1\. 把判断螺帽的属性追加到订单。

※可以利用现有订单的属性设定判断条件。

1.1.打开订单表

1.2. 在表格左上角右键，打开表格设置。

![](media/ebda60801e01d5202f53a17a541ddc2f.png)

1.3. 设置字段ID[UserStr1]的自定义显示为螺帽。

![](media/a4c3664c4257e2370faff528a4f2d114.png)

1.4. 点击“保存”按钮关闭对话框，就在订单表里追加了新属性“螺帽”。

然后，在这个属性里设定所用的螺帽种类。

![](media/75850bc955e08898395a2fcc116b7887.png)

2.如下所示，设定 X2的制造BOM。

![](media/995672a520b5323f95e2e2bfd26147fd.png)

1.  在工艺产能，如下所示，在AX的KD工序追加输入指令行，这样，在AX上输入的有X 和 X2。

![](media/ea41cf68e0e10ed84189974271618654.png)

4\. 为了根据订单的螺帽的值切换输入品目，设定X输入指令的指令有效条件表达式。

4.1.1 在AX的KD工序里，点击X输入指令的指令有效条件里的F3按钮。

在表达式编辑对话框里，设定

ME.UserStr1=='X' \|\|FValid(ME.UserStr1)==FALSE

表达式。意思是，如果订单的螺帽设定为“X”或者空的，就在AX上使用X。

※FValid函数是排产易的内部函数，在参数里所设定的属性如果有值则返回TRUE，如果没有则返回FALSE。

![](media/298897a325e2fc7ad6a247fbdbf7d54b.png)

5\. 为了根据订单的螺帽的值切换输入品目，设定X2输入指令的指令有效条件表达式。

5.1.1 在AX的KD工序里的X2输入指令的指令有效条件中设定

ME.UserStr1=='X2'

表达式意思是，如果订单的螺帽设定为“X2”，就在AX上使用X2。

![](media/511b571c87422f65e48f5fa4e5960931.png)

6\. 追加部品X2的制造订单。

![](media/f70aff37d10c4f87af3d733fb4cac76a.png)

7\. 将AX的制造订单的「螺帽」设定为“X2”。

![](media/6a96819fdde0cd71eaa0282f201a3b10.png)

重新排程。于是，按照条件AX的订单与X2的订单关联了起来。

![](media/529dcb08b2e3a31bab2652c2cfe37e01.png)

8\. 这次反过来将AX的制造订单的「螺帽」设定为“X”。

![](media/6d6e2b10caff6384265b7ded9d3ed98a.png)

重新排程。于是，按照条件AX的订单与X的订单关联了起来。

![](media/4a06fad7d4afe78c7e3252d0eea03da5.png)

可见，有2个部品构成的AX能够在1个工艺产能里设定，根据条件来分别使用。

### 2a12 技能表

技能表是矩阵似的录入各作业员的技能，并且反映在排程过程。它使有关作业员技能的制造BOM的录入和维护变得非常简单，录入的数据量大幅度地减少。

在当前的设定里，部品X和X2是用资源CK2（即检查作业员）检查的。把检查作业员增加到３人，根据作业员的检查技能：

-   能否制造部品X、X2
-   检查速度的快慢（熟练者能够短时间内检查完）

设定技能表。

1.  打开资源表，如下所示，追加资源CK2-A、CK2-B和CK2-C。已设定的CK2保持不变，作为资源组使用。设定CK2-A、CK2-B、CK2-C的资源组为CK2。

![](media/5b055965b684525854e987b3dff70c95.png)

1.  为了资源甘特图便于观察，如下所示，设定CK2-A、CK2-B、CK2-C的显示颜色和显示顺序。

![](media/980d8754ed9717cb4b55468d6874b22e.png)

3\. 如果技能值设定为大于等于「1」，就能够检查。

设定CK2-C的技能1和技能2的值为1，使之能够制造X和X2。

![](media/5e7a1b1a0ecb39e8f2cc3de2ae02d70b.png)

4\. 设定资源有效表达式

在品目X的CK2的资源有效条件式里

ME.X检查技能\>=1

在品目X2的CK2的资源有效条件式里

ME.X2检查技能\>=1

如上设定。这样，如果X检查技能（技能1）大于等于1就能够分派X，如果X2检查技能（技能2）大于等于1就能够分派X2。

※在资源有效条件式里的「ME」指的是资源。

![](media/db0b6e41b8a04d75cf2c901ce365b64e.png)

7\. 重新排程，在资源甘特图上确认分派结果。

在制造BOM设定里，虽说资源组CK2里面的资源（CK2-A、CK2-B、CK2-B）都可以分派，但是在资源有效条件式里设定了技能值必须大于等于1。

结果，品目X和品目X2都分派到CK2-C上。

![](media/b4686e06361384739bb2bfb86217e8cb.png)

8\. 现在改变作业员的技能。

设定CK2-A能够检查品目X，CK2-B能够检查品目X2。把技能值

CK2-A X检查技能为2

CK2-B X2检查技能为2

如上变更。

这样，就会变成品目X分派到CK2-A上，品目X2分派到CK2-B上。

![](media/d461b06682aa0b91fcd6cd78cc6ffea0.png)

9\. 重新分派，在资源甘特图上确认分派结果。

变更技能设定的结果显示，品目 X 分派到 CK2-A 上，品目 X2 分派到 CK2-B 上。

![](media/d4adf58896594d4910c4edff69f9b2ab.png)

10\. 根据技能值可以设定能否分派。

下面将技能值反映到能力上。在工艺产能里，把品目X和X2的使用指令模版CK2的能力做如下变更

2mp/OTHER.Skill1

2mp/OTHER. Skill2

在使用指令模版的制造的表达式里“OTHER”同“ME”一样表示对象。在[能力]里“OTHER”指的是要分派的资源，因此在上述的表达式里技能值越大制造时间越短。

![](media/634c786c8750f0888969e1481630dba8.png)

11\. 重新排程,在资源甘特图上确认分派结果。

技能值反映到能力上的结果是工作的时间缩短了。

![](media/95db63b2a962f38775b0972aee85eee3.png)

这样使用排产易 BOM的模版数据就设定完了。

## 2b消除订单逾期、缩短制造提前期的技巧

排产易具有缩短所制定计划的制造提前期和解除订单逾期的各种各样的功能。让我们实际运用这些功能。

-   准备

在此数据里，只设定了物料A的模版数据。我们稍微扩充一下物料A的模版数据，并且追加物料B、C这2个模版数据。

1.首先，在物料A的工艺产能里，为了向PR工序里追加另一个候补资源，如下所示在使用指令里设定2个资源。

![](media/43767e638003cbbc64d7606ff9ddf7cf.png)

2.接着，让我们追加物料B、C的模版数据。

可以直接输入，但是因为设定内容同物料A相似，所以如果复制物料A的模版构成会更简便。复制物料A的时候，按住Shift右击复制行，再粘贴行。

1.  这样用与物料A相同的模版构成制作出物料B。此后如下所示仅需要动手修正物料B和物料A的不同项目。

![](media/e744f2c0055a4acd9a0d5c20018832ae.png)

1.  同样地，追加物料C，动手修正不同的项目。

![](media/515dbad7007f79f4e3effb2e888bc32c.png)

5.如图所示，输入10个制造订单。

![](media/13e9207af756729dc666d0df1a0e0d1d.png)

这样就完成了准备工作。以这个排程结果为基础，应用缩短制造提前期和解除订单逾期的各种各样的功能。

### 2b1 确认逾期的制造订单

确认逾期的制造订单。

1.  在资源甘特图上确认重新排程的结果。于是，出现几个逾期的制造订单。

![](media/f5a4202ac3e856472f92f2fa12114f70.png)

2\. 打开消息窗口，可以看到逾期制造订单数为 5。

![](media/097414e01be97896a592474e1156e8ec.png)

接下来，使用几种功能解除订单逾期、缩短制造提前期。

### 2b2 变更开工时间，解除订单逾期

变更工作时间，试验能否解除订单逾期。

1.  逾期的原因之一是资源 CT1 的工作时间不足，从资源甘特图的分派状态可以看到。因此，增加 CT1 的工作时间看一看。首先在班次表里追加新的出勤模式[S2]。

![](media/da5110fe3d48140c2d70328dad65673b.png)

2\. 在生产日历表上追加 CT1 的生产生产时间。

![](media/9241927e15e731ef5fe420ac56796245.png)

4\. 那么重新排程。在消息窗口可以看到，通过增加资源 CT1 的工作时间使逾期制造订单率从 50%降到 20%。

![](media/7f93e0d6306486c6ac0b93ab324bcd9e.png)

![](media/a21ba063ea0935af7fc9818428c1d886.png)

### 2b3 分割制造订单，解除订单逾期

试一试通过分割制造订单，缩短制造提前期、解除订单逾期。

1\. 通过分割制造订单缩短制造提前期。由此解除订单逾期。

2\. 分别将制造数量为 200 的订单 04、06、08、09 分割成数量为 100 的 2 个订单。

![](media/bb3c20ecaac1eefb8d9de78bd2b76335.png)

1.  重新排程。

![](media/38e3d1889ffb37eca8aa352e8b464a81.png)

观察重新排程的结果。通过订单分割，制造提前期比上次缩短了，而且对于订单 10的A-20 的工作来说，解除了订单逾期。但是，仍然有未解除逾期的订单。

### 2b4 分割工作，解除订单逾期

试一试通过分割工作，缩短制造提前期、解除订单逾期。通过分割工作使其分派到别的资源上，可以缩短制造提前期。由此，能够减少订单逾期。

1\. 将第 2 道工序的工作全部分割成 2 个，并行分派到 2 个资源上。可以选择要分割的工作，在其属性窗口上设定。分割数量和工作并行数量。但是，在这里我们通过工作表来设定。

2\. 在排产引擎的打开工作表。

3\. 把工序编号[20]的所有工作的工作分割数量和工作并行数量分别设定为[2]、[2]

![](media/13861fd5ab970d505526adadf0aa6284.png)

4．重新排程。

![](media/02aa5fcf5c1695bb668e0e219620cee5.png)

从资源甘特图可以看到分割后的工作分派到了2个资源上。由此，从整体上缩短了制造提前期，解除了订单逾期。

### 2b5 变更接续方法，解除订单逾期

还可以变更接续方法(SSEE, ESE, EES)，缩短制造提前期，解除订单逾期。

为了让前工序和本工序的工作重叠生产而变更接续方法，缩短制造提前期，解除逾期现象。

1.  在2b3的排程结果上，将所有物料的CK工序的接续方法变更为[SSEE]。

![](media/efffe759052136c36439906ae4906362.png)

1.  重新排程。

![](media/6101b3b9573c0da56cc0674ecf570277.png)

通过将接续方法变更为 SSEE，各工序的工作重叠分派了。由此，缩短了制造提前期，解除了订单逾期。

## 2c 命令与排产方案

**命令**

命令是排产易的一种对象，其特征是[执行(什么)]。命令的种类有：分派工作的命令、展开订单的命令、调用存储过程的命令等。命令和排产易的其它对象一样也为阶层结构。执行这种阶层结构的命令时，按照排列在阶层结构内的顺序依次执行。

**排产方案**

排产方案为了制定计划（排程）而设定的方案。可以在排产方案里设定制定计划（排程）时所必需的命令。

下图是预先设定的排产方案参数的构成图。

![](media/58065fdae093d6dcaf147ad98b78df81.png)

执行常规排产方案时，按照「订单收集」→「订单筛选」→「解除分派」……的顺序，执行所登录的内部命令。关于内部命令的详细介绍请参照帮助文档。

### 2c1 设定分派规则

1\. 首先，在订单表里如下图所示输入订单 01、02、03，重新排程。

2\. 在消息窗口里确认分派的顺序。可以看到：按订单优先度的高低顺序分派的。

![](media/27bdd0d744709af6427b81ba9a662891.png)![](media/78459f7f1f795e1abff9308f0a57d525.png)![](media/a397c11a0c2ecab8fe7fc7c3649d745d.png)

1.  点击排产方案管理的按钮，选择分派规则设定对话框。

![](media/dc607f159213d29631be982379d48a68.png)

在这里，分派顺序取决于所设定的分派键的顺序。根据这一设定，订单优先度高的工作先分派。如果有多个优先度相同的订单，那么交货期早的先分派。

1.  在此，如果将订单交货期的键排到第一行，则相反地交货期早的先分派。交货期相同就开始以订单优先度作为顺序的基准。要将订单交货期排到第一行：

![](media/66f928aa008ba1387a49ab84f10192da.png)

1.  重新排程。在消息窗口里可以看到从交货期早的订单开始分派的。

![](media/a6933a150d0bad7e1645ed77db74ba61.png)![](media/787be480eb0ec699844c605368147da2.png)

### 2c2 设定评估表达式

工作有多个候补资源的时候，排产易使用评估式作为资源的选择基准。要设定评估式，先选择排产方案参数设置，然后在属性窗口的评估式属性里设定值。

在这次的数据里第一和第三道工序有副资源，其候补资源有Oper1和Oper2。另外，第一道工序的主资源有两个候补资源CT1和CT2。

1.  确认制造 BOM 的内容。

    ![](media/3c554fa47b2283cf1c34505acf8244fd.png)

2.  在资源表中确认 CT2、Oper1、Oper2 的显示颜色、显示顺序。

![](media/0cdcd87c3e08ce2f38ffd53d5fe1f7bc.png)

1.  确认在订单表里是否设定了 10 个订单。

    ![](media/251cd924fd13e915ff1fb67c7dd01016.png)

4\. 让我们确认排产方案参数的评估式。

点击排产方案参数设置按钮，接着点击资源策略,点击![](media/d07d4269c330db5d1afdbb42fdb13270.png)可以确认所选评估式的各个权重的设定值。

![](media/1f1760f384fcf6133eed92a53e402857.png)

1.  负荷均衡化、逾期最小化、制造时间最小化的权重设定为１。这样，如果重新排程，那么在分派工作的过程中候补资源有多个的时候，排产易会选择
2.  造能力高且负荷小的资源。其结果，以某种程度分散负荷而将工作分派到资源CT1・CT2和Oper1・Oper2上。

![](media/2ba4c0dd1842871f40deb65660887519.png)

常规下评估式适用于所有资源，但是如果在评估式的对象资源属性里设定了资源，那么该评估式就只适用于指定的资源。

7\. 现在我们执行更高级的排程。假定还是希望Opr1和Opr2作业员自己切割后自己检查，让此规则反映在计划参数中。

7.1. 在排产方案参数设置修改资源选择策略。

7.2. 在对象资源属性里录入 Oper1 和 Oper2。

7.3. 在相同订单优先属性和负荷均衡化属性里设定1。

![](media/613e14fa4b78574f04145d2222fde2f4.png)

1.  重新排程，在资源甘特图上确认分派结果。可以看到不论哪个订单，切割工序和检查工序的副资源都在同一个资源上。

    ![](media/654b89da792c948e3e30230a924495c9.png)

### 2c3 订单筛选、期间设定、复合排程

在这次数据里所登录的订单中，有交货期为 10 日和 20 日的订单。立刻制造 20 日的订单有些过早，因此设定交货期为 20 日的订单在 11 日以后分派。

1.  这样分成两个计划参数进行设定，以多个步骤制定计划。为了更明显地看到后面分派的结果。

1.1新增排产方案ABC，在排产方案ABC下新建方案10。

![](media/aa3e5306b8266ca4632961095eb267c6.png)

1.2设置订单筛选。在属性选择交货期，在条件里选择[小于]，在值里录入\#2003/10/11\#，按确认按钮。

![](media/f75369565b2c131e93fcb5be622748ef.png)

1.  重新排程，于是只分派交货期早于 11 日的订单。

![](media/8ee54f5a2ac88875d73e1fa017cab1fc.png)

1.  接下来制作分派剩余订单的计划命令
    1.  在排产方案ABC新建方案20。

        ![](media/686282841acb86bc99e9d30219efb2a6.png)

2.2.设置订单筛选，在属性里选择[交货期]，在条件里选择[大于]，在值里录入\#2003/10/11\#，最后按确认按钮。

![](media/5e0a6e7270e8300244768724502e45df.png)

1.  在排产方案参数期间标签，设置分派开始时间为\#2003/10/11\#。

    ![](media/e21af5757c98b5e04792473d62e0236d.png)

2.4重新排程，于是 20 日的订单在 11 日以后分派。

![](media/945a738fe03c5dee71f32e40f7a98547.png)

这样，先排方案 10 之后排产方案20，且各方案只依次分派了自己筛选的数据。

1.  直接执行排产方案ABC，利用命令的构造可以让２个方案连续运行。

3.1. 重新排程，于是排产方案ABC下面的方案 10 和 20 连续运行。大家可以看到分派结果是一样的。

### 2c4 正方向/逆方向排程

到目前为止，生产计划以正方向排程，从左到右分派工作。相反，从交货期开始向左分派工作叫做逆方向排程。

通过排产方案的分派方向属性的设定，可以不受订单分派方向影响而一律正向分派或者逆向分派。在这里进行逆方向分派。

![](media/7fb39d3daeedc8b9fb29dfc9b5a46847.png)

重新排程，于是各订单以交货期为基点逆方向分派。

![](media/cf565e7b431f0a1deda4a179d6480094.png)

### 2c5瓶颈中心排程

从现在的分派结果我们可以明显地看到，第二道工序的资源 PR1 是全体计划的瓶颈。不管单纯的正向排程还是逆向排程，从结果来看都因工序之间的等待时间过长而中间库存增大。

像这样的单纯范例中，如果固定瓶颈工序之后再进行排成便可以解除等待时间过长的现象。

1\. 实习使用手动调整。

1.1. 用鼠标选择分派在资源PR1上的工作。

1.2. 点击工具栏的固定按钮。

![](media/76ed58fef0d5f235ae0443504c304084.png)

如此，固定工作然后重新排程。前后工作靠拢固定的工作而分派，因此一次排程之后固定瓶颈资源再排程即可。

![](media/12a076b11e17c831cf2027c807bfe77f.png)

2\. 接下来，我们用两种方法来尝试自动调整。

再次用鼠标选择刚才固定的工作，单击右键选择工作非固定。首先，制作跟上面手动操作完全相同效果的排产方案参数。我们可以使用排产方案参数的工作临时固定属性来实现它。

1.  排产方案参数设置。
    1.  设定工作临时固定属性为瓶颈资源。

        ![](media/0874580e0fc8ff86ee90a80372c4c077.png)

        为了使现在制作的排产方案的工作临时固定属性的瓶颈资源有效，设定资源PR1的瓶颈资源属性。

    2.  选择资源PR1，设定瓶颈资源属性为瓶颈资源。

![](media/f81cda6b72d418dd109b99fed65ffdb6.png)

2.4. 为了返回前面的状态选择标准排产方案（订单级）后进行重新排程。

2.5. 然后再用[瓶颈]参数方案重新排程，现在自动地实现了刚才用手动固定资源 PR1 的工作后排程的操作。

3\. 另外一种方法是，不使用工作临时固定，而是把分派在 PR1 前工序的资源 CT1 和 CT2 上的工作逆向分派。

3.1将计划返回前面的状态。选择 排产方案ABC后重新排程。

3.2新方案的制作。

设定新建方案名称为[CT]，将如图的内部命令按照顺序追加到[CT]的下

面。

![](media/8ce234f4d497c09493d88b7f3aeb07ca.png)

3.3 设置工作筛选条件。筛选主资源为CT1和CT2的工作。

![](media/b8b0e12f8be56598b9d935d7361518b4.png)

3.4设置CT工作的分派方向为逆方向。分派资源设定为当前资源。

![](media/1f0d3704dcdb8c5c61382119303dace8.png)

1.  使用方案[CT]排程，我们可以看到只有第一道工序的工作从瓶颈工序开始逆向分派。针对排产方案ABC的分派结果进行比较。和固定瓶颈资源工作的方法不同的是，只对第一道工序的资源 CT1、CT2 上的工作进行了再分派，对其它的工序没有影响。

![](media/c88a4581c5f321191cb52c30a7454711.png)

## 2d 资源条件设定及更现实设定的追加

现在为止 ABC 公司使用 排产易的各种功能，实现了制造提前期的缩短和交货期遵守率的提高。对于今后销售规模扩大，设定了提高计划精度的目标。而且，为了提高品质也变更了检查方法，从而也出现了应对上述变化的必要性。

### 2d1 按照资源量设定资源的资源量制约

1\. 工序 PR 中追加新的资源 PR2。资源 PR2 的特征如下：

-   有两个加工机器人，可以同时制造 2 个(PR1 只有 1 个)。
-   与 PR1 相比，设置时间长。

另外，因为设置时间变长了，所以规定这个新的资源只有在制造数量为 110 个以上时才可以使用。

2\. 工艺产能的设定。

PR 工序中，设定新建资源[PR2]的设置时间和能力值。

![](media/048f68aa10f7b8f924ed510f7e7a2fa9.png)

3\. 生产日历的设定。

为了反映资源量追加资源 PR2 的生产日历。１台机器的资源量为１，２台资源量就为２。

PR2 的默认资源量设定为 2。PR2 既匹配现有的日历记录(第一行)，也匹配新建的日历记录（第二行），因此将第二行的「优先级」设定得大一些，这样 PR2 将使用第二行的记录。

![](media/c980140897418d38bd5b0b74b40b7570.png)

4\. 资源的设定。

因为 PR2 使用两个机器同时处理一个工作，所以设定资源量制约属性为「按资源量分派」。

4.1. 设定资源PR2的制约方法为“按资源量分派”。

![](media/a0ac67e53c15f40ee30cce903c8a6667.png)

这样一来，分派工作时使用全部的资源量，可以缩短制造时间。

另外，为了更容易看资源甘特图，请设定显示颜色和显示顺序。

![](media/28548ae0ecb3b8911bfdea3b1772925c.png)

5\. 重新排程。

与 PR1 比较 PR2 的能力值高，因此 PR 加工中分派的资源也发生了变化。因为设定了 2 台加工机器人，所以制造时间大幅度地缩短。

### 2d2 设定资源的分派有效条件

资源PR2在前设置中非常消耗时间，因此制造数量为 110 个以上时才可以使用；而资源PR1只有在制造数量小于110 的时候才可以使用。

1\. 设定资源的分派有效条件表达式。分别对资源 PR1、PR2 设定“分派有效

条件表达式”。

![](media/5704622e0b49c25f67f98857a727f1b3.png)

2.1. 让我们确认一下根据分派有效条件以及“按资源量分派”的设定所产生的排程结果。在这里，订单 01 的数量是 100 个，追加订单 02数量 200。

![](media/042c78e36d9ed1b53f9d80877c3ce654.png)

数量为 100 的订单 01 分派在资源 PR1 上，大于 110 的订单 02 分派在资源 PR2 上面。

### 2d3 设置制造中断时间MAX的设定

第 3 道工序检查工序中，上午和下午有换班，而且假定批量均已确定了作业员。从而第 3 工序需要不跨非工作时间而连续安排生产。另外，假定资源 PR2 的前设置非常复杂，也需要不跨非工作时间而连续安排生产。

1\. 制造中断时间 MAX/设置中断时间 MAX。

中段时间 MAX 的设定在各个资源的属性里进行。从分派有效条件以及“按资源量分派”的设定所产生的排程结果订单看，订单01的工序PR的设置和制造任务中断，订单02 的工序 CK 的制造时间中含有中断。分别对每个资源，设定制造中断时间 MAX 以及前设置中断时间 MAX。

-   PR1 的前设置中断时间 MAX = -1
-   CK1 的制造中断时间 MAX = -1

如上设定。在前设置中断时间 MAX、制造中断时间 MAX、后设置中断时间 MAX 里输入负值，意思是不允许一切中断时间。还有，前/后设置和制造之前中断时间 MAX 设定为负值，则不允许设置任务和制造任务分开分派。

重新排程，于是分派结果如下图所示：

![](media/c0b5f33cd9f662f575f4e824796922a0.png)

上述设定为“不跨越”非工作时间。如果最大允许跨越“60 分”的时候，则设定为“60”分。

## 2e 与工作相关的各种制约

在这一节中，说明关于工作的分派方向、数量的计算方法等逻辑。

### 2e1 关于时间固定级别的说明以及设定

1\. 时间固定级别。

所有的工作都有时间固定级别，使用该时间固定级别决定工作的分派方向。决定分派方向的基本原则是拉拢时间固定级别小的非固定工作，尽量使制造提前期缩短。

例如，假定订单如下图所示分派。

![](media/1c21d450ef23bfb0db2e6699e4a7887f.png)

将订单中的某个工作用鼠标如下图进行移动。

![](media/b36792376a12b1cee96b6079acc6afe6.png)

移动后被移动的工作的时间固定级别变为 10。这种状态下重新排程，于是时间固定级别小的工作被拉到时间固定级别大的工作附近。

![](media/a518a5241721f4a00793f4fd2ab38717.png)

每个状态的固定级别的缺省值。

| **状态** | **缺省的时间固定级别** |
|----------|------------------------|
| 结束     | 50                     |
| 开始生产 | 40                     |
| 确定     | 30                     |
| 指示完毕 | 20                     |
| 固定     | 10                     |
| 计划完毕 | 0                      |

### 2e2 数量固定级别的说明以及设定

1\. 数量固定级别。

所有的工作都有数量固定级别，使用数量固定级别决定订单内工作的数量。一般来说，以数量固定级别最大的工作为基准计算前后工序的工作数量。

每个状态的数量固定级别默认值。

| **状态** | **缺省的数量固定级别** |
|----------|------------------------|
| 结束     | 50                     |
| 开始开始 | 40                     |
| 确定     | 30                     |
| 指示完毕 | 20                     |
| 固定     | 0                      |
| 计划完毕 | 0                      |

对订单 01 的 CT 工序（02:10）的实绩开始时间设定为2003/09/30 13:00:00。

假设在 PR 工序发生不良品，实绩数量完成了 50 个(设定在第一工序中没有取得实绩)，实绩结束时间为10 月 2 日上午 11 点。

![](media/1bc71e850d75972357cea4c77b95f677.png)

另外，计划基准时间设定为 2003 年 10 月 3 日。

![](media/cce1cdd1e5230238a6c4e306b6a9d5e7.png)

重新排程，于是结果如下。

![](media/d2aeec122223d21a7f700e09cfb28f31.png)

## 2f 数据原型的制作——热处理的追加

导入排产易以后，ABC 公司进行了市场调查。调查结果表明产品「AX」的大部分客户选择产品的基准从以前的「低价格」转移到了「安全性」。根据这样的信息，为了确保更大的市场占有率，因此决定提供对强度较弱的品目「A」进行热处理来提高强度的选项。

为了支持热处理选项，将工序进行以下变更。

以前的工序 切割 (CT) + 加工 (PR) + 检查 (CK)

新工序 切割 (CT) + 加工 (PR) + 热处理 (HT) + 检查 (CK)

作为热处理方法，预定提供以下的选项。

没有热处理 （以前的生产过程）

低温度处理

中温度处理

高温度处理

公司内部进行热处理的资源有一台。但是，由于是平时稼动率较高的资源，仅用一台很可能会出现供不应求的现象。因此，最后决定在初期阶段以下面的条件实行外协分派。

HT1 公司内部的炉 数量为小于 100 的订单

HTG 外协 数量为大于 100 的订单

公司内部的炉具有以下特征：

1\. 炉是批处理型的，处理时间与数量无关而固定为 6 个小时。

2\. 如果温度要求相同，就可以同时处理 3 个工作。

3\. 处理过程中炉门不能打开，这样同时进行处理的工作必须同时放入同时取出。

4\. 改变温度的设定时，根据以下温度的前后关系将发生设置工作。

![](media/9d4c1f1bc6f738a721a247da30a26598.png)

转换温度设置表

5\. 设置与制造中需要安排作业员（资源代码＝HTS）。

6\. 炉作业员的工作时间为 8:00-21:00。

7\. 不属于本系统计划范围的物料也用这个炉，因此，物料[A]的处理只在每周的星期一和星期二进行，而其它时间原则上进行其它产品的处理。

8\. 一旦放进了炉资源就不能中断。

热处理的外协工厂具有以下特征：

1\. 从公司内部工厂向外协工厂移动需要一定的时间，公司内部的加工结束后，外协工厂通常在第二天的早晨就可以开始工作。

2\. 外协的详细生产计划委托给外协工厂，因此在排产易中进行无限能力排程，将提前期设定为两天的固定值。

-   排产易设置概要

接下来，为了追加热处理工序进行模板数据的变更。从使用之前物料A的数据进行变更。确认变更设定后，再根据练习进行剩下的设定。最后，使用相同的数据进行几个其它功能的练习。

| 需要变更的部分 | 工序选定器（两种生产工艺的输入） 工序 HT 的追加 资源 HT1 的能力设定 资源 HT1 的生产日历设定 测试用的订单输入                                                                                                                                                                    |
|----------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 需要设定的部分 | 订单的规格（处理温度）设定 工序选定器有效条件 规格的显示颜色 由于规格切换产生的前后依赖的设置时间 炉资源作业员 HTS 的追加 炉资源 资源量设定 外协资源 HTG 的追加 任务选定器（资源组合的设定）  任务选定器有效条件 外协资源 HTG 的移动时间设定 无限能力的设定 中断时间 MAX 的设定 |
| 其它功能的设定 | 炉有效条件表达式 根据规格的分派条件 由于品目转换产生的前后依赖的设置时间 由于副资源转换产生的前后依赖的设置时间 使用指令有效条件                                                                                                                                                |

-   更改现有数据
1.  工艺产能

![](media/08877b943501841659a7be974abff386.png)

工序选定器的列中输入有1和2这样的值，其设定表示有两种生产工艺。工序选定器 1 为以前的生产工艺，工序选定器 2 为包括热处理工序的生产工艺。这个设定表示同样的物料A有追加热处理的生产方法和没有热处理的生产方法。工序 HT 中设定有资源 HT1，制造能力值设定 6h 固定时间。

1.  生产日历

    日历设置表和班次如下所示：

    ![](media/2b0088f61fdaaa862e748ba51b31ff3a.png)![](media/87aa606e40cf606290f74ef25eb76933.png)

从上面可以确认到资源 HT1 在星期一和星期二的 8:00-21:00 可以使用，在其它的时间不可使用。

1.  制造订单

    ![](media/eb54637a632d209dd318015276a63c03.png)

物料A 的订单输入了 24 个，数量 100 的订单和 50 的订单混杂在一起。

4．重新排程

![](media/bab3817f11778aa33bc6302ac22c3167.png)

图中分派有 24 个订单，两个生产工艺当中只使用了其中的一个(没有热处理的方法)。下面，实习剩余的设定，使计划能像这一节背景中说明过的生产计划那样进行。

### 2f1 订单规格（处理温度）的设定

设定订单的规格（处理温度）。

排产易中，将[温度][颜色][长度][宽度]等任意一个属性通过变更生产特征1\~10的名称来设定。ABC公司中，因为根据[处理温度]不同，设置时间与生产工艺将随之发生变化，所以变更[生产特征1]属性名称为[温度]来进行处理温度的设定。

1\. 规格可以在订单、物料表中设定。

1.1. 在订单中设定的时候，就作为该订单的特征使用。

1.2. 在物料中设定的时候，就适用于没有设定或者相同特征的订单。

2\. ABC热处理方法与订单数量有关，因此在订单表设定生产特征。

2.1打开制造订单表，变更生产特征1的名称。打开表格设置，在生产特征1输入自定义显示[温度]。

![](media/84b70ee252ab32aa100e2896383fac5b.png)

2.2在订单表的温度列。输入[无热处理]、[高]、[中]、[低]。

![](media/c26a1f1656e48336f2698b33746edfe6.png)

### 2f2 工序选定器有效条件的设定

设定工序选定器有效条件。

订单的温度属性为[高][中][低]表示需要通过热处理，而温度属性为[无热处理]表示不通过热处理工序的生产工艺。这种条件设定在工艺产能的[工序选定器表达式]。

1.  输入工序选定器1和工序选定器2的条件表达式。

![](media/a6d2839a190b336360fe7ec311877ddf.png)

1.  重新排程看一下。

    ![](media/cf17c1fea6b4df9f7bf2deb8cb7093ac.png)

    观察甘特图，可以看到一部分订单经过热处理，一部分不经过。

### 2f3 用规格表示显示颜色的设定

甘特图上的图棒显示订单的颜色，试一下使用生产特征的颜色来显示。

1.  在生产特征1输入显示颜色。

    ![](media/c3f537b7ac8a802168ca15ba31570854.png)

2.  在甘特图显示设置将棒显示颜色设定为[生产特征1].

    ![](media/98b7cd938ea2e1dc39810320f0924379.png)

    ![](media/9ff63f9d6a768d9575209c2335df3ef4.png)

    这样，甘特图的图棒就用订单生产特征１的颜色显示了。温度属性为[无热处理]的订单（灰色的订单）不经过热处理，其它订单经过热处理工序，一目了然。

### 2f4 由于特征切换而发生的切换时间的设定

设定由于特征转换产生的前后依赖的设置时间。

输入项目

资源 （输入对象资源代码。例：HT1）

前特征 （输入生产特征１代码。例：低）

后特征 （输入生产特征１代码。例：中）

设置时间 （用分单位设定。例：180）

优先级 （越想优先，设定值也越高。例：100）

1.  打开生产特征1切换，输入切换信息，根据情节背景中介绍的温度转换设置表进行设定。优先级可以 输入任意值，这里输入[100]。

![](media/892bd6da56fa04002b4f931c95c6a185.png)

第一行数据代表前特征等于后特征时，切换时间为0.

1.  重新排程

    热处理工作之间发生了设置工作，可以看到设置时间长度也符合温度转换表。

![](media/9d4d130032302d1c04bc7a32f32dc048.png)

### 2f5 追加炉资源的作业员

追加炉资源的作业员 HTS。

1.  打开工艺产能，新增工序HT的使用指令，前设置时间和制造时间输入为[0]，于是前设置和制造就都配备该作业员。

![](media/9701dbd41c22883a84db2d89686e834a.png)

2.打开日历设置表，设定资源 HT1 的生产日历也适用于资源 HTS。

![](media/d89034e3a6a365226ca4d4bfc706ff1a.png)

3\. 重新排程，于是可以看到：作业员[HTS]和热处理工序的资源[HT1]同时被分派了工作。

![](media/20930bcf7a9f9f07ab45ff501db32338.png)

### 2f6 设定资源量

在资源HT1上设定[只要温度相同，就最多可同时处理3个工作]的制约。同时，设定作业员HTS[可以进行最多 3 台的多台管 理]的制约。

1.变更日历设置表，设定资源为3个。

![](media/713c571650f57bc1496fa9c607a1d3ac.png)

2.在工艺产能里，资源HTS的使用指令的必要资源量设定为[0.33](1 除以 3 的数)，设定 1 个人可以最多管理 3台机器。

![](media/1887811ecd61440599e5a5c86ee93674.png)

3.重新排程。

![](media/2386be76bf874ef6ded2ce3bf9ba6001.png)

可以看到：资源HT1变为能够同时处理３个工作。在HT1的行里有白线表示有３个资源，而HTS里没有白线，可知 1 个人管理多台机器进行生产。

### 2f7 设定炉资源

设定[只有温度要求相同的工作才可以同时进行热处理]。

1.  设定HT1为炉资源。

    ![](media/3d55f35bf95e1cbec2f1ff3c6f7e34d6.png)

2.设定HT1的炉有效条件式。只有温度相同的工作才能同时进行。

![](media/5e82c134c785da3dad8b8b4ea5288671.png)

3.重新排程。

![](media/eaa3b6aacac7a6087ec95f6bb0a3381b.png)

从图棒的颜色可以看到：只有工作的处理温度一样的情况下才可以同时处理，而且进行热处理的工作必须同时投入同时取出。

### 2f8 设定外协资源

HT1的设定到此为止，接下来追加外协资源 HTG。设定外协资源时，一般来说可以像设定公司内部资源一样进行设定。

1.  打开工艺产能，在工序HT里追加使用指令，如下设定：

![](media/b5ad82c67c342f8e2882eb5f30cd033a.png)

2.设定资源HTG的显示颜色和显示顺序。

![](media/9490bbe676d9e991575093db3bb9f23b.png)

3.设定资源HTG的生产日历。

![](media/37242c7e6447121e0af331c37dbb0abe.png)

4.重新排产。

![](media/0fa91167219a3ebdfd4e4cec708f0fe2.png)

追加外协资源 HTG 之后的排程结果

### 2f9 设定任务主资源（资源的组合）

现在，已经可以在外协资源上分派工作，但结果显示作业员 HTS 也管理外协的工作，违反了作业员仅做公司内部工作的规定。设定资源的组合的时候，使用任务选定器。

1.  打开工艺产能，将工序HT的HT1和HTS使用指令的任务选定器设定为[1]，HTG的使用指令的任务选定器设定为[2]。这种设定的意思是，[在工序HT里有两种生产方法，一种是HT1和HTS成对使用，另一种是单独使用 HTG]。

![](media/8fc5d1b18514b0e44682cf1a21cf0f03.png)

1.  重新排程。

![](media/6de87e56dd4fdc2f237b49253d62fc5c.png)

可以确认 HTS 只在 HT1 时使用。

### 2f10任务选定器有效条件的设定

下面，进行数量为50个的订单在公司内生产，100个的订单由外协工厂生产的设定。

1\. 打开工艺产能，选择工序HT的任务选定器 1。在任务选定器条件表达式输入：ME.Order.Qty \< 100。

2\. 同样地，在任务选定器2的条件表达式里录入以下表达式。

ME.Order.Qty \>= 100

3.重新排程。

![](media/02ac6c108e276484bbdc645cb4e9edec.png)

设定任务选定器有效条件之后的排程结果

可以看到：只有数量为100（以上）的订单分派到HTG上。

### 2f11 外协资源的移动时间的设定

设定外协资源 HTG 的移动时间。现在的模板数据设定中，向资源 HTG 的移动时间（移动时间 MIN）和 HT1 同样 60 分钟，修改为[从第二天的上午 0 点开始工作]。

1\. 打开工艺产能，将资源 HTG 的使用指令的移动时间变更为[H1D]

![](media/c2541659fb31dbad88410b1ea9dd3189.png)

2.重新排程。

![](media/819f803ab534eb268513d43790f647ea.png)

可以看到：HTG 上分派的工作是前工序结束后的第二天上午 0 点开始的。

### 2f12 设定无限能力

设定无限能力。 最后，像情节背景中记述的那样，设定外协资源 HTG 的无限能力。 在资源表上，将HTG的制约方法设定为[不制约]。

![](media/9272e38d83b81d0b5e07d8d5994de98b.png)

重新排程。

![](media/0b477791614e5de6ef42a4937bb3d133.png)

外协资源 HTG 设定为无限能力之后的排程结果

可以看到：在资源 HTG 上工作以无限能力自由地堆积。

### 2f13 制造中断时间 MAX、设置中断时间 MAX 的设定

设定炉资源从开始生产到结束不能制造中断。选择资源 HT1，设定制造中断 MAX 以及前设置中断 MAX（-1代表不能中断）。

![](media/f0a7d4163860657944329ac2401d108b.png)

重新排程。

![](media/78c01305148cc8503adaee2ef4e2bf08.png)

可以看到：资源 HT1 没有发生中断现象。 这样，完成了热处理工序的追加。

## 2g 数据原型的制作——其它功能

-   继续使用2g的最终数据。

### 2g1 根据规格的分派条件的设定

在上个章节(2f)中，我们完成了热处理的追加。接下来，在下一个工序中根据炉的温度进行资源分派的设定。工序 PR 中有2个资源 PR1、PR2，设定资源 PR1只处理温度为[无热处理」或[低」的工作，而资源PR2只处理温度为[中]或[高]的工作。

1.  将资源 PR1 的规格１设定为[无热处理;低]，资源 PR2 的规格１设定为[中;高]。

    ![](media/b3308fafb93c5fad24b617c63b820763.png)

2.  重新排程，于是温度为[无热处理][低]的工作分派到PR1，[中][高]的分派到PR2上。

![](media/1d918e8a81b85f3be33ffe7303f31c70.png)

### 2g2 由于物料切换、副资源切换而发生的切换时间的设定

在实习 2f4 中实习了由生产特征转换而发生的前后依赖设置时间的设定，制造中的物料进行转换以及使用中的资源进行转换时所发生的设置时间也可以同样进行设定。

1.  设定由于物料转换而发生的前后依赖的设置时间的时候，从菜单打开物料切换表，进行设定。

    1.1设定在资源CT1上，前物料不等于后物料时，切换时间为60分钟。

![](media/23e3b258c3ffbbad4a2c90d121a2abe8.png)

1.2 重新排程，可以看到在CT1上相同物料切换时间为0，不同物料切换时间为60。

![](media/f29ffcf78ff0e6fc4f56167b599f6566.png)

2\. 设定由于资源转换而发生的前后依赖的设置时间的时候，从菜单打开资源切换表，进行设定。

2.1 设定在资源CK1上，副资源Oper1切换到副资源Oper2的切换时间为0。

![](media/27457a164025b74d88c1297de08a92d9.png)

![](media/f989b0e57247d6b242cfcd1a74884b9d.png)

2.2 重新排程，可以看到副资源Oper1到Oper2的切换时间为60。

![](media/0e02a943e538a05c2ae1896eb8e64431.png)

### 2g3 使用指令有效条件的设定

实习 2f2 和实习 2f10 中实习了工序选定器有效条件和任务选定器有效条件的设定，使用指令也可以设定同样的有效条件。使用指令有效条件也可以在工艺产能上设定。

例如，想表达[生产特征2]为[红]，就需要配备作业员」的设定，使用任务选定器制作 2 套模板数据也可以，不过在使用指令中设定有效条件表达式，可以减少模板数据的量。

1.在工艺产能设定指令有效条件。

![](media/0e73f2600ef1a47962214754caf9c371.png)

2.在制造订单设定生产特征2。

![](media/e8465fd85f7f6f080351a71d33b43cdf.png)

3.重新排程。可以看到[生产特征2]为[红]的才配备作业员CTS。

![](media/57c70445877ac287f32898f4213a3b68.png)

## 附录A 利益增大诊断确认表

| 利益增大诊断确认表 |          |
|--------------------|----------|
| 公司名.工厂名      |  ABC公司 |

-   适用于系统的预定产品群

|  螺栓 |   |
|-------|---|
|       |   |

-   产品的工序流程

| 品目名   |  螺栓       | 螺帽        | 螺栓        |
|----------|-------------|-------------|-------------|
| 品目代码 |  A，B，C    |  X          |  AX，BX，CX |
| 品目种类 |  半成品     | 半成品      | 成品        |
| 品目数量 |  3          | 1           | 3           |
| 月产量   |  50000      | 50000       | 50000       |
| 工序1    |  切割（CT） | 成型（PR）  | 组装（CK）  |
| 工序2    |  加工       | 检查2       |  检查3      |
| 工序3    |  检查1      |             |  包装       |

※包装工序中，根据包装状态，分为 100 个包装和 200 个包装

-   各工序的设备、作业员、外协

| 工序名称 | 机器的种类（台数）、作业员的人数、外协的名称 | 出勤模式         |
|----------|----------------------------------------------|------------------|
| 切割     | 切割机(CT1、CT2)、作业员(CTS：2 名)、外协    | 白班（S1）、外协 |
| 加工     | NC 机(PR1、PR2、PR3)、作业员(PRIN：2 名)     | 白班（S1）       |
| 检查1    | 检查机(CK1)、作业员(CKR：2 名)               | 白班（S1）       |
| 成型     | 成型机(IJ1)                                  | 白班（S1）       |
| 检查2    | 检查机(CK2)、作业员(2 名)                    | 白班（S1）       |
| 组装     | 组装机(KD1)、作业员(2 名)                    | 白班（S1）       |
| 检查3    | 检查机(CK3)、作业员(2 名)                    | 白班（S1）       |
| 包装     | 打包机(PK1)、作业员(2 名)                    | 白班（S1）       |

-   出勤模式

|            |                             |       |
|------------|-----------------------------|-------|
| 白班（S1） | 8:00 - 12:00; 13:00 - 17:00 |  每天 |
| 加班（S2） | 8:00 - 12:00; 13:00 - 20:00 |       |
|  外协      | 全日                        |       |

| 推测为瓶颈的工序 | 组装 |
|------------------|------|

-   订单的状况和处理方法

| 订单的形态                                       | □预测生产 □销售生产 ■预测生产和销售生产的混合                                                                                                |                                      |   |
|--------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------|---|
| 销售订单                                         | 5000 件/月                                                                                                                                   | 从客户来的出货单位的订单             |   |
| 制造订单                                         | 1500 件/月                                                                                                                                   | 工厂中制造单位的完成品或半成品的订单 |   |
| 采购订单                                         | 300 件/月                                                                                                                                    | 向供应商预订资材的订单               |   |
| 完成品的 制造订单 制作方法 (※可选择多个)         | □从销售预测/需求预测制作 □从MPS(主生产计划)系统的输出制作 ■从客户的内示信息制作 ■从销售订单制作 □在Excel 等工具上手动制作 □其它              |                                      |   |
|                                                  |                                                                                                                                              |                                      |   |
|                                                  |                                                                                                                                              |                                      |   |
|                                                  |                                                                                                                                              |                                      |   |
|                                                  |                                                                                                                                              |                                      |   |
| 半成品(部品) 的制造订单 的制作方法 (※可选择多个) |  □从MRP 系统的输出制作半成品(部品)的制造订单 □在Excel 等工具上手动制作 ■其它                                                                 |                                      |   |
|                                                  |                                                                                                                                              |                                      |   |
|                                                  |                                                                                                                                              |                                      |   |
|                                                  |                                                                                                                                              |                                      |   |
| 采购订单 的制作方法 (※可选择多个)                | □从MRP 系统的输出制作 □以销售订单为基础制作 □以(预测的)制造订单为基础制作 □提前订购交货期长的品目 ■在Excel 等工具上手动制作 □客户提供 □其它  |                                      |   |
|                                                  |                                                                                                                                              |                                      |   |
|                                                  |                                                                                                                                              |                                      |   |
|                                                  |                                                                                                                                              |                                      |   |
| 紧急订单                                         | ■有 □无                                                                                                                                      |                                      |   |
| 试制品订单                                       | ■有 □无                                                                                                                                      |                                      |   |
| 平均交货提前期                                   |  7天                                                                                                                                         | 如果有每个产品的数据就请附上         |   |
| 平均制造提前期                                   | 5天                                                                                                                                          | 如果有每个产品的数据就请附上         |   |
| 交货期遵守率 订单件数基准 数量基准 金额基准      | 73% 80% 80%                                                                                                                                  | 遵守交货期的比率。                   |   |
|                                                  |                                                                                                                                              |                                      |   |
|                                                  |                                                                                                                                              |                                      |   |
|                                                  |                                                                                                                                              |                                      |   |

-   库存的状况

| 完成品库存 |  周转天数 10天 、15000万元 |
|------------|----------------------------|
| 半成品库存 |  周转天数 20天 、12000万元 |
| 采购品库存 |  周转天数 40天 、4400万元  |

-   生产计划的制作方法

| 计划制作周期   |  一周一次 |
|----------------|-----------|
| 计划制作期间   |  一周     |
| 排程方法       |  正方向   |
| 平均制造提前期 |           |

-   生产管理系统的现状

|              | 系统开发公司（者）              | 导入时间 |
|--------------|---------------------------------|----------|
| 模板数据管理 |  无                             |          |
| 销售管理     |  自己公司开发                   |  2000/6  |
| 大日程计划   |  无                             |          |
| 小日程计划   |  无                             |          |
| MRP          |  MRP-Pro(美国 MRP-Pro 公司制作) |  2002/6  |
| 工作指示     |  无                             |          |
| 实绩收集     |  无                             |          |
| 进展管理     |  无                             |          |
| 库存管理     |  无                             |          |
| 出货管理     |  无                             |          |
| 采购管理     |  无                             |          |

-   模板数据等的管理方法

| 模板数据信息的所在 | ■主机上 □PC 上 □文书管理 □其它                       |
|--------------------|------------------------------------------------------|
| 销售信息的所在     | ■主机上 □PC 上 □文书管理 □其它                       |
| 工作指示的方法     | ■手写的指示书 □从计算机输出指示书 □其它              |
| 工作指示中条形码   | □使用 ■未使用                                        |
| 实绩收集方法       | ■手写的日报 □手动输入到计算机 □POP系统等系统化 □其它 |

-   生产计划上，填入相关的瓶颈问题点

    ①针对客户的订单，不能正确地判断是否能按照交货期交货。

    ②希望将制造提前期缩短到1/2。

    ③希望将交货期遵守率提高到100%。

    ④希望削减半成品库存。

## 附录B 利益增大诊断确认表

| 利益增大诊断确认表 |   |
|--------------------|---|
| 公司名.工厂名      |   |

-   适用于系统的预定产品群

|   |   |
|---|---|
|   |   |

-   产品的工序流程

| 品目名   |   |   |   |
|----------|---|---|---|
| 品目代码 |   |   |   |
| 品目种类 |   |   |   |
| 品目数量 |   |   |   |
| 月产量   |   |   |   |
| 工序1    |   |   |   |
| 工序2    |   |   |   |
| 工序3    |   |   |   |
| 工序4    |   |   |   |
| 工序5    |   |   |   |

-   各工序的设备、作业员、外协

| 工序名称 | 机器的种类（台数）、作业员的人数、外协的名称 | 出勤模式 |
|----------|----------------------------------------------|----------|
|          |                                              |          |
|          |                                              |          |
|          |                                              |          |
|          |                                              |          |
|          |                                              |          |
|          |                                              |          |
|          |                                              |          |
|          |                                              |          |

-   出勤模式

|   |   |   |
|---|---|---|
|   |   |   |
|   |   |   |
|   |   |   |

| 推测为瓶颈的工序 |   |
|------------------|---|

-   订单的状况和处理方法

| 订单的形态                                       |                                                                                                                                              |   |   |
|--------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------|---|---|
| 销售订单                                         |                                                                                                                                              |   |   |
| 制造订单                                         |                                                                                                                                              |   |   |
| 采购订单                                         |                                                                                                                                              |   |   |
| 完成品的 制造订单 制作方法 (※可选择多个)         | □从销售预测/需求预测制作 □从MPS(主生产计划)系统的输出制作 □从客户的内示信息制作 □从销售订单制作 □在Excel 等工具上手动制作 □其它              |   |   |
|                                                  |                                                                                                                                              |   |   |
|                                                  |                                                                                                                                              |   |   |
|                                                  |                                                                                                                                              |   |   |
|                                                  |                                                                                                                                              |   |   |
| 半成品(部品) 的制造订单 的制作方法 (※可选择多个) |  □从MRP 系统的输出制作半成品(部品)的制造订单 □在Excel 等工具上手动制作 □其它                                                                 |   |   |
|                                                  |                                                                                                                                              |   |   |
|                                                  |                                                                                                                                              |   |   |
|                                                  |                                                                                                                                              |   |   |
| 采购订单 的制作方法 (※可选择多个)                | □从MRP 系统的输出制作 □以销售订单为基础制作 □以(预测的)制造订单为基础制作 □提前订购交货期长的品目 □在Excel 等工具上手动制作 □客户提供 □其它  |   |   |
|                                                  |                                                                                                                                              |   |   |
|                                                  |                                                                                                                                              |   |   |
|                                                  |                                                                                                                                              |   |   |
| 紧急订单                                         |                                                                                                                                              |   |   |
| 试制品订单                                       |                                                                                                                                              |   |   |
| 平均交货提前期                                   |                                                                                                                                              |   |   |
| 交货期遵守率 订单件数基准 数量基准 金额基准      |                                                                                                                                              |   |   |
|                                                  |                                                                                                                                              |   |   |
|                                                  |                                                                                                                                              |   |   |
|                                                  |                                                                                                                                              |   |   |

-   库存的状况

| 完成品库存 |   |
|------------|---|
| 半成品库存 |   |
| 采购品库存 |   |

-   生产计划的制作方法

| 计划制作周期   |   |
|----------------|---|
| 计划制作期间   |   |
| 排程方法       |   |
| 平均制造提前期 |   |

-   生产管理系统的现状

|              | 系统开发公司（者） | 导入时间 |
|--------------|--------------------|----------|
| 模板数据管理 |                    |          |
| 销售管理     |                    |          |
| 大日程计划   |                    |          |
| 小日程计划   |                    |          |
| MRP          |                    |          |
| 工作指示     |                    |          |
| 实绩收集     |                    |          |
| 进展管理     |                    |          |
| 库存管理     |                    |          |
| 出货管理     |                    |          |
| 采购管理     |                    |          |

-   模板数据等的管理方法

| 模板数据信息的所在 |   |
|--------------------|---|
| 销售信息的所在     |   |
| 工作指示的方法     |   |
| 工作指示中条形码   |   |
| 实绩收集方法       |   |

-   生产计划上，填入相关的瓶颈问题点
